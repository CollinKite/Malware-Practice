#include <Windows.h>
#include <stdio.h>
#include <iostream>
int main(void)
{
	STARTUPINFOW si = {};
	PROCESS_INFORMATION pi = {};


	if (CreateProcessW(
		L"C:\\Windows\\System32\\notepad.exe",
		NULL,
		NULL,
		NULL,
		FALSE,
		NORMAL_PRIORITY_CLASS,
		NULL,
		NULL,
		&si,
		&pi))
	{
		printf("(+) process started with the PID of %ld \n", pi.dwProcessId);

		HANDLE hndl = OpenProcess(PROCESS_ALL_ACCESS, NULL, pi.dwProcessId);
		if (hndl != nullptr)
		{
			printf("(+) process handle is %p \n", hndl);
			return EXIT_SUCCESS;
		}

	}
	printf("(-) failed to open process handle");
	return EXIT_FAILURE;
}